---
method: post
---


{% liquid
	graphql result = 'item/create', name: context.params.title 

	assign ingredients= context.params.ingredient|split: ','

	
	



	

	if result.record.id 

	
	
	for ingred in ingredients
	graphql ingredientExist='item/ingredient/search_bytitle' , title:ingred

if  ingredientExist.record.id

assign itemList =ingredientExist.record.itemID|append: result.record.id 

  graphql updateItemList='item/ingredient/update_itemList', id:result.record.id ,item_id:itemList

  else

  graphql createIngredient='item/ingredient/create' ,title:ingred ,itemID:result.record.id

  endif

	endfor
	
	redirect_to '/'
	
	
	
	else
		echo 'Something went wrong'
		echo result.errors
	endif
%}