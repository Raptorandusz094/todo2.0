---
method: post
---


{% liquid
	
     assign ingredientIDs=[]
	assign ingredients= context.params.ingredient | split: ','

	for ingred in ingredients
	
	graphql ingredientExist='item/ingredient/search_bytitle' , title:ingred
	
    if  ingredientExist.records.total_entries == 0

       graphql createIngredient='item/ingredient/create' ,title:ingred 

        ingredientIDs=ingredientIDs|concat: createIngredient.records.id 

	else 
	ingredientIDs=ingredientIDs|concat: ingredientExist.records.id 


	 endif

	endfor
	
	
	graphql result = 'item/create', name: context.params.title ,ingredientID:ingredientIDs
	redirect_to '/'
	
	
	
	else
		echo 'Something went wrong'
		echo result.errors
	endif
%}